-----Original Message-----
From: jteyi@isevolutionsconsult.com <jteyi@isevolutionsconsult.com>
Sent: Wednesday, 16 October 2024 10:12 am
To: Acobbinah <acobbinah@isevolutionsconsult.com>;
jjdoku@isevolutionsconsult.com; efrimpong@isevolutionsconsult.com
Subject: Arbutus Donewell

Hello All,



Find attached file as discussed.




--
Justice Teyi
Associate Technical Consultant
Mobile: +233 579 720 290
Website: www.isevolutionsconsult.com
 2 attachments
  • Scanned by Gmail
Gmail virus scanners are temporarily unavailable – The attached files haven't been scanned for viruses. Download these files at your own risk.




IMPORT OPENEXCEL TO MATCHED_RETURNS FILE "%V_OUTPUT_FOLDER%\REV_ASS_POLICIES_%V_FILE_NAME%.xlsx" TABLE "MATCHED_RETURNS" SERVER "LOCAL" FLAT "MATCHED_RETURNS.FIL" ASCII FIELDS ALL END

IMPORT OPENEXCEL TO MATCHED_RTN_DIFF_ALLOC_TERMINAL FILE "%V_OUTPUT_FOLDER%\REV_ASS_POLICIES_%V_FILE_NAME%.xlsx" TABLE "MATCHED_RTN_DIFF_ALLOC_TERMINAL" SERVER "LOCAL" FLAT "MATCHED_RTN_DIFF_ALLOC_TERMINAL.FIL" ASCII FIELDS ALL END

IMPORT OPENEXCEL TO MATCHED_RTN_DIFF_ALLOC_ACTIVE FILE "%V_OUTPUT_FOLDER%\REV_ASS_POLICIES_%V_FILE_NAME%.xlsx" TABLE "MATCHED_RTN_DIFF_ALLOC_ACTIVE" SERVER "LOCAL" FLAT "MATCHED_RTN_DIFF_ALLOC_ACTIVE.FIL" ASCII FIELDS ALL END

IMPORT OPENEXCEL TO MATCHED_RTN_DIFF_AMT_SAME_ALLOC FILE "%V_OUTPUT_FOLDER%\REV_ASS_POLICIES_%V_FILE_NAME%.xlsx" TABLE "MATCHED_RTN_DIFF_AMT_SAME_ALLOC" SERVER "LOCAL" FLAT "MATCHED_RTN_DIFF_AMT_SAME_ALLOC.FIL" ASCII FIELDS ALL END

IMPORT OPENEXCEL TO MATCHED_RTN_DIFF_AMT_DIFF_ALLOC FILE "%V_OUTPUT_FOLDER%\REV_ASS_POLICIES_%V_FILE_NAME%.xlsx" TABLE "MATCHED_RTN_DIFF_AMT_DIFF_ALLOC" SERVER "LOCAL" FLAT "MATCHED_RTN_DIFF_AMT_DIFF_ALLOC.FIL" ASCII FIELDS ALL END

IMPORT OPENEXCEL TO ONLY_IN_RETURNS FILE "%V_OUTPUT_FOLDER%\REV_ASS_POLICIES_%V_FILE_NAME%.xlsx" TABLE "ONLY_IN_RETURNS" SERVER "LOCAL" FLAT "ONLY_IN_RETURNSC.FIL" ASCII FIELDS ALL END



OPEN PREMIUM_BALANCE_EXT_INST
TOTAL FIELD PREMIUM
vTotalPremium = TOTAL1


OPEN MATCHED_RETURNS
TOTAL FIELDS  DEC(OPR_PREM_PYMT_AMT + OPR_PENS_PYMT_AMT,2)
vMatched_Allocated = total1


OPEN MATCHED_RTN_DIFF_ALLOC_TERMINAL
TOTAL FIELDS  val(OPR_PREM_PYMT_AMT + OPR_PENS_PYMT_AMT,2)
vMat_DIFF_AMT_Allocated = total1


OPEN MATCHED_RTN_DIFF_ALLOC_ACTIVE
TOTAL FIELDS val(OPR_PREM_PYMT_AMT + OPR_PENS_PYMT_AMT,2)
 vMat_DIFF_AMT_TERM_Allocated = total1


OPEN MATCHED_RTN_DIFF_AMT_SAME_ALLOC
TOTAL FIELDS  VAL(OPR_PREM_PYMT_AMT + OPR_PENS_PYMT_AMT,2)
vMat_DIFF_SAME_AMT_Allocated = total1


OPEN MATCHED_RTN_DIFF_AMT_DIFF_ALLOC
TOTAL FIELDS  VAL(OPR_PREM_PYMT_AMT + OPR_PENS_PYMT_AMT,2)
vMat_DIFF_AMT_Allocated1 = total1

vPremium_Allocated = vMatched_Allocated + vMat_DIFF_AMT_Allocated + vMat_DIFF_AMT_TERM_Allocated + vMat_DIFF_SAME_AMT_Allocated + vMat_DIFF_AMT_Allocated1




OPEN MATCHED_RTN_DIFF_ALLOC_TERMINAL
TOTAL FIELDS val(BALANCE,2) IF (POL_TERMINATION_DATE = `19000101`)
vBefore_Terminal_1 = TOTAL1




OPEN MATCHED_RTN_DIFF_ALLOC_TERMINAL
TOTAL FIELDS DEC(BALANCE,2) IF ((OPR_DEDUCTION_DATE > POL_TERMINATION_DATE) and not (month( POL_TERMINATION_DATE ) = month(OPR_DEDUCTION_DATE ) and year( POL_TERMINATION_DATE ) = year(OPR_DEDUCTION_DATE ))) AND (POL_TERMINATION_DATE <> `19000101`)
vBefore_Terminal = TOTAL1

OPEN MATCHED_RTN_DIFF_ALLOC_TERMINAL
TOTAL FIELDS DEC(BALANCE,2) IF MONTH( OPR_DEDUCTION_DATE) = MONTH( POL_TERMINATION_DATE) AND YEAR( OPR_DEDUCTION_DATE) = YEAR( POL_TERMINATION_DATE)
vDuring_Terminal = TOTAL1

OPEN MATCHED_RTN_DIFF_ALLOC_TERMINAL
TOTAL FIELDS DEC(BALANCE,2) IF MONTH( OPR_DEDUCTION_DATE) < MONTH( POL_TERMINATION_DATE) AND YEAR( OPR_DEDUCTION_DATE) = YEAR( POL_TERMINATION_DATE)
vAfter_Terminal = TOTAL1




OPEN MATCHED_RTN_DIFF_ALLOC_ACTIVE
TOTAL FIELDS DEC(BALANCE,2) IF Pol_Status2 = "DC"
vDC_DIFF_AMT_TERM_Allocated = total1

OPEN MATCHED_RTN_DIFF_AMT_SAME_ALLOC
TOTAL FIELDS value(BALANCE,2) IF Pol_Status2 = "DC"
vDC_DIFF_SAME_AMT_Allocated = total1

OPEN MATCHED_RTN_DIFF_AMT_DIFF_ALLOC
TOTAL FIELDS VAL(BALANCE,2) IF Pol_Status2 = "DC"
vDC_DIFF_AMT_Allocated = total1


vAllocatedDC = vDC_DIFF_AMT_TERM_Allocated + vDC_DIFF_SAME_AMT_Allocated + vDC_DIFF_AMT_Allocated




OPEN MATCHED_RTN_DIFF_ALLOC_ACTIVE
TOTAL FIELDS DEC(BALANCE,2) IF Pol_Status2 = "L"
vLP_DIFF_AMT_TERM_Allocated = total1

OPEN MATCHED_RTN_DIFF_AMT_SAME_ALLOC
TOTAL FIELDS val(BALANCE,2) IF Pol_Status2 = "L"
vLP_DIFF_SAME_AMT_Allocated = total1

OPEN MATCHED_RTN_DIFF_AMT_DIFF_ALLOC
TOTAL FIELDS VAL(BALANCE,2) IF Pol_Status2 = "L"
vLP_DIFF_AMT_Allocated = total1


vAllocatedLP = vLP_DIFF_AMT_TERM_Allocated + vLP_DIFF_SAME_AMT_Allocated + vLP_DIFF_AMT_Allocated




OPEN MATCHED_RTN_DIFF_ALLOC_ACTIVE
TOTAL FIELDS DEC(BALANCE,2) IF Pol_Status2 = "A"
vA_DIFF_AMT_TERM_Allocated = total1

OPEN MATCHED_RTN_DIFF_AMT_SAME_ALLOC
TOTAL FIELDS val(BALANCE,2) IF Pol_Status2 = "A"
vA_DIFF_SAME_AMT_Allocated = total1

OPEN MATCHED_RTN_DIFF_AMT_DIFF_ALLOC
TOTAL FIELDS VAL(BALANCE,2) IF Pol_Status2 = "A"
vA_DIFF_AMT_Allocated = total1


vAllocatedActive = vA_DIFF_AMT_TERM_Allocated + vA_DIFF_SAME_AMT_Allocated + vA_DIFF_AMT_Allocated


OPEN ONLY_IN_RETURNS
TOTAL FIELDS DEC(PREM,2) IF Pol_Status = "D"
vDraftTotal = TOTAL1


OPEN MATCHED_RETURNS
TOTAL FIELDS NOT_CREDITED
vMatched_Allocated_Not_Credited = total1

OPEN MATCHED_RTN_DIFF_ALLOC_TERMINAL
TOTAL FIELDS NOT_CREDITED
vMat_DIFF_AMT_Allocated_Not_Credited = total1

OPEN MATCHED_RTN_DIFF_ALLOC_ACTIVE
TOTAL FIELDS DEC(NOT_CREDITED,2)
vMat_DIFF_AMT_TERM_Allocated_Not_Credited = total1

OPEN MATCHED_RTN_DIFF_AMT_SAME_ALLOC

TOTAL FIELDS value(NOT_CREDITED,2)
vMat_DIFF_AMT_Allocated_sME_Not_Credited = total1


OPEN MATCHED_RTN_DIFF_AMT_DIFF_ALLOC
TOTAL FIELDS VAL(NOT_CREDITED,2)
vMat_DIFF_AMT_Allocated_Not_Credited = total1

vPremium_Allocated_Not_Credited = vMatched_Allocated_Not_Credited + vMat_DIFF_AMT_Allocated_Not_Credited + vMat_DIFF_AMT_TERM_Allocated_Not_Credited + vMat_DIFF_AMT_Allocated_sME_Not_Credited + vMat_DIFF_AMT_Allocated_Not_Credited



OPEN MATCHED_RTN_DIFF_ALLOC_ACTIVE
TOTAL FIELDS DEC(BALANCE,2) IF (SmartSearch("V", Pol_Status2)) AND Pol_Status2 <>'A'
vV_DIFF_AMT_TERM_Allocated = total1

OPEN MATCHED_RTN_DIFF_AMT_SAME_ALLOC
TOTAL FIELDS VAL(BALANCE,2) IF (SmartSearch("V", Pol_Status2)) AND Pol_Status2 <>'A'
vV_DIFF_SAME_AMT_Allocated = total1

OPEN MATCHED_RTN_DIFF_AMT_DIFF_ALLOC
TOTAL FIELDS VAL(BALANCE,2) IF (SmartSearch("V", Pol_Status2)) AND Pol_Status2 <>'A'
vV_DIFF_AMT_Allocated = total1


vAllocatedV = vV_DIFF_AMT_TERM_Allocated + vV_DIFF_SAME_AMT_Allocated + vV_DIFF_AMT_Allocated




OPEN MATCHED_RTN_DIFF_ALLOC_ACTIVE
TOTAL FIELDS DEC(BALANCE,2) IF POL_STATUS2 =''
vEmpty_DIFF_AMT_TERM_Allocated = total1

OPEN MATCHED_RTN_DIFF_AMT_SAME_ALLOC
TOTAL FIELDS VAL(BALANCE,2) IF  Pol_Status2 =''
vEmpty_DIFF_SAME_AMT_Allocated = total1

OPEN MATCHED_RTN_DIFF_AMT_DIFF_ALLOC
TOTAL FIELDS VAL(BALANCE,2) IF  Pol_Status2 =''
vEmpty_DIFF_AMT_Allocated = total1


vAllocatedvEmpty = vEmpty_DIFF_AMT_TERM_Allocated + vEmpty_DIFF_SAME_AMT_Allocated + vEmpty_DIFF_AMT_Allocated



OPEN MATCHED_RTN_DIFF_ALLOC_ACTIVE
TOTAL FIELDS DEC(BALANCE,2) IF REGEXFIND( Pol_Status2, 'S|M|C')
vTerminal_TERM_Allocated = total1

OPEN MATCHED_RTN_DIFF_AMT_SAME_ALLOC
TOTAL FIELDS VAL(BALANCE,2) IF  REGEXFIND( Pol_Status2, 'S|M|C')
vTerminal_TERM_Allocated1 = total1

OPEN MATCHED_RTN_DIFF_AMT_DIFF_ALLOC
TOTAL FIELDS VAL(BALANCE,2) IF  REGEXFIND( Pol_Status2, 'S|M|C')
vTerminal_TERM_Allocated2 = total1



vTerminatedAmt = vTerminal_TERM_Allocated + vTerminal_TERM_Allocated1 + vTerminal_TERM_Allocated2


OPEN BANK_RETURNS_IMP_FINAL
TOTAL FIELDS PREM
vPrem = total1




v_Total_Diff = vPrem - vPremium_Allocated- vBefore_Terminal - vDuring_Terminal - vAfter_Terminal - vAllocatedDC - vAllocatedLP - vAllocatedV - vAllocatedActive - vPremium_Allocated_Not_Credited - vDraftTotal - vAllocatedvEmpty - vTerminatedAmt

vDiff = vTotalPremium



OPEN MATCHED_RTN_DIFF_ALLOC_TERMINAL
TOTAL FIELDS IFNUM(BALANCE) THEN DEC(BALANCE, 2) ELSE VAL(BALANCE, 2) IF (POL_TERMINATION_DATE = `19000101`)
vBefore_Terminal_1 = TOTAL1


*EXPORT DELIMITED TO "%V_OUTPUT_FOLDER%\REV_ASS_POLICIES_%V_FILE_NAME%" FIELDS GROUPNAME vTotalPremium AS ' PREMIUM RETURNS(GH)'vPrem as 'PREMIUM RETURNS'  vPremium_Allocated as 'PREMIUM ALLOCATED' vBefore_Terminal AS ' BALANCE(TERMINAL TRANSACTION) BEFORE' vDuring_Terminal AS ' BALANCE(TERMINAL TRANSACTION) MONTH UNDER DISCUSSION'  vAfter_Terminal AS 'BALANCE(TERMINAL TRANSACTION) AFTER'  vAllocatedDC AS 'BALANCE( DEATH CLAIM POLICIES)' vAllocatedLP AS ' BALANCE (LAPSED POLICIES)' vAllocatedActive AS 'BALANCE(ACTIVE POLICIES)' vPremium_Allocated_Not_Credited AS 'NOT CREDITED NOR AT BALANCE(CANCELLED PROPOSAL AND NOT CONVERTED)' vDraftTotal AS 'DRAFT' vAllocatedV AS 'V' vAllocatedvEmpty AS 'EMPTY STATUS' BLANK(20) AS 'DIFFERENCE' v_Total_Diff as '' SEPARATOR "|" QUALIFIER '"' IF RECNO() =1


EXPORT FIELDS V_FILE_NAME AS 'GROUPNAME'  vPrem as 'UPLOAD DATA'  vPremium_Allocated as 'PREMIUM ALLOCATED' vBefore_Terminal_1 as 'BALANCE(TERMINAL TRANSACTION) EMPTY' vTerminatedAmt as 'Terminated' vBefore_Terminal AS ' BALANCE(TERMINAL TRANSACTION) BEFORE' vDuring_Terminal AS ' BALANCE(TERMINAL TRANSACTION) MONTH UNDER DISCUSSION'  vAfter_Terminal AS 'BALANCE(TERMINAL TRANSACTION) AFTER'  vAllocatedDC AS 'BALANCE( DEATH CLAIM POLICIES)' vAllocatedLP AS ' BALANCE (LAPSED POLICIES)' vAllocatedActive AS 'BALANCE(ACTIVE POLICIES)' vPremium_Allocated_Not_Credited AS 'NOT CREDITED NOR AT BALANCE(CANCELLED PROPOSAL AND NOT CONVERTED)' vDraftTotal AS 'DRAFT' vAllocatedV AS 'V' vAllocatedvEmpty AS 'EMPTY STATUS' v_Total_Diff AS 'DIFFERENCE' '' as '' EXCEL TO "%V_OUTPUT_FOLDER%\REV_ASS_POLICIES_%V_FILE_NAME%" TABLE "SUMMARY RESULT"   IF RECNO() =1

script.txt
You may be offline or with limited connectivity. Try downloading instead.